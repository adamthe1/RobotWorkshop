<mujoco model="panda scene (bar table)">
  <include file="panda_nokey.xml"/>

  <statistic center="0.3 0 0.4" extent="1"/>

  <visual>
    <headlight diffuse="0.6 0.6 0.6" ambient="0.3 0.3 0.3" specular="0 0 0"/>
    <rgba haze="0.15 0.25 0.35 1"/>
    <global azimuth="120" elevation="-20"/>
  </visual>

  <!-- Enable no-slip solver and increase solver effort; reduce timestep for more robust contacts.
       Revert: remove timestep/iterations/ls_iterations to go back to defaults. -->
  <option timestep="0.0015" iterations="200" ls_iterations="60" noslip_iterations="10" noslip_tolerance="1e-6"/>

  <asset>
    <texture type="skybox" builtin="gradient" rgb1="0.3 0.5 0.7" rgb2="0 0 0" width="512" height="3072"/>
    <texture type="2d" name="groundplane" builtin="checker" mark="edge" rgb1="0.2 0.3 0.4" rgb2="0.1 0.2 0.3"
      markrgb="0.8 0.8 0.8" width="300" height="300"/>
    <material name="groundplane" texture="groundplane" texuniform="true" texrepeat="5 5" reflectance="0.2"/>

    <!-- simple solid-colored table material -->
    <material name="table_mat" rgba="0.75 0.65 0.55 1" specular="0.2" shininess="0.2"/>
    <material name="cup_mat" rgba="0.95 0.95 0.95 1" specular="0.1" shininess="0.2"/>

    <!-- translucent green glass for wine bottle -->
    <material name="glass_green" rgba="0.1 0.6 0.2 0.4" specular="0.5" shininess="0.6" reflectance="0.1"/>
    <!-- cork material for bottle top -->
    <material name="cork_mat" rgba="0.55 0.35 0.2 1" specular="0.05" shininess="0.05"/>
  </asset>

  <worldbody>
    <light pos="0 0 1.5" dir="0 0 -1" directional="true"/>
    <geom name="floor" size="0 0 0.05" type="plane" material="groundplane"/>


    <!-- table only: simple rectangular bar table in front of the robot (lowered, moved slightly away) -->
    <body name="table" pos="0.8 0.0 0.3">
      <geom type="box" size="0.3 0.9 0.35" material="table_mat" contype="1" conaffinity="1"
            friction="3.0 0.08 0.008"/>
    </body>

    <!-- square wine bottle placed on the table top (movable) -->
    <!-- New table top at z = 0.3 + 0.35 = 0.65. Body halfheight = 0.14 => center z = 0.79 -->
    <body name="wine_bottle" pos="0.75 0.0 0.79">
      <joint name="bottle_free" type="free"/>
      <!-- square bottle body (box) -->
      <!-- Mass/friction tuned for gripping: was density="2500", friction="3.0 0.08 0.008" -->
      <!-- Revert: restore density and original friction above -->
      <!-- Note: impratio not supported in your MuJoCo version; removed. -->
      <!-- Harden contact to prevent penetration. Was: solref="0.005 1" solimp="0.95 0.99 0.001" -->
      <!-- Revert: restore those solref/solimp values. -->
      <geom name="bottle_body" type="box" size="0.035 0.035 0.14" material="glass_green" mass="0.5"
            contype="1" conaffinity="1" condim="6" friction="5.408 0.2366 0.04225"
            solimp="0.95 0.995 0.0005" solref="0.004 1" />
      <!-- square bottle neck (box) on top of body: halfheight 0.06 placed 0.20 above body center (0.14 + 0.06) -->
      <!-- Mass/friction tuned for gripping: was density="2500", friction="2.5 0.06 0.006" -->
      <!-- Revert: restore density and original friction above -->
      <!-- Note: impratio not supported in your MuJoCo version; removed. -->
      <!-- Harden contact to prevent penetration. Was: solref="0.005 1" solimp="0.95 0.99 0.001" -->
      <!-- Revert: restore those solref/solimp values. -->
      <geom name="bottle_neck" type="box" size="0.012 0.012 0.06" pos="0 0 0.20" material="glass_green"
            mass="0.09" contype="1" conaffinity="1" condim="6" friction="5.408 0.2366 0.04225"
            solimp="0.95 0.995 0.0005" solref="0.004 1" />
      <!-- small cork as box at top of neck -->
      <!-- Mass tuned for total ~0.6kg bottle: was density="700" -->
      <!-- Revert: restore density above -->
      <geom name="bottle_cork" type="box" size="0.012 0.012 0.01" pos="0 0 0.27" material="cork_mat"
            mass="0.01" contype="1" conaffinity="1" friction="2.0 0.08 0.008" />
    </body>

    <!-- add a simple cup next to the bottle -->
    <body name="cup" pos="0.78 0.12 0.71">
      <joint name="cup_free" type="free"/>
      <geom name="cup_body" type="cylinder" size="0.03 0.06" material="cup_mat" density="1200"
            contype="1" conaffinity="1" friction="3.0 0.08 0.008" />
    </body>
  </worldbody>
</mujoco>
